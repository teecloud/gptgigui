<app-page-toolbar title="Cart"></app-page-toolbar>

<ion-content>
  @if (cart.selectedItem$ | async; as item) {
    <ion-card>
      <ion-button
        class="close-btn"
        fill="clear"
        size="small"
        aria-label="Close"
        (click)="cart.clear()"
      >
        <ion-icon name="close"></ion-icon>
      </ion-button>
      <div
        class="image"
        [style.backgroundImage]="'url(' + (item.imageUrl || 'assets/placeholder-rect.jpg') + ')'"
      ></div>
      <ion-card-header>
        <ion-card-title>{{ item.title }}</ion-card-title>
        @if (item.price != null) {
          <ion-card-subtitle>
            {{ item.price | currency:'USD':'symbol':'1.0-0' }}
          </ion-card-subtitle>
        }
      </ion-card-header>
      @if (item.selectedSlot) {
        <ion-card-content>
          <p>Scheduled at {{ item.selectedSlot }}</p>
        </ion-card-content>
      }
    </ion-card>
    <app-payment-button
      [amount]="(item.price || 0) * 100"
      [item]="item"
      [scheduledSlot]="item.selectedSlot"
      (transactionCompleted)="onPaymentComplete()"
      (transactionFailed)="onPaymentFailed($event)"
    ></app-payment-button>
  } @else {
    <ion-list>
      <ion-item>
        <ion-label>Your cart is empty.</ion-label>
      </ion-item>
    </ion-list>
  }
</ion-content>
